---
import { actions } from "astro:actions";
import { db, Reaction, eq } from "astro:db";
import { Heart } from "lucide-react";
const { postSlug } = Astro.props;

const reaction = await db
  .select()
  .from(Reaction)
  .where(eq(Reaction.postSlug, postSlug))
  .get();

const loves = reaction?.loves || 0;
---

<div
  class="flex items-center gap-1 bg-white rounded-lg px-4 py-3 shadow-sm border border-gray-100 w-fit mb-4">
  <form method="POST" action={actions.addLove} class="inline-flex">
    <input type="hidden" name="postSlug" value={postSlug} />
    <button
      type="submit"
      class="appearance-none border-none bg-transparent cursor-pointer p-0 flex items-center gap-2 text-gray-600 hover:text-pink-600 transition-colors duration-200 group">
      <span
        class="text-lg group-hover:scale-110 transition-transform duration-200"
        ><Heart size={21} /></span
      >
      <span class="text-sm font-medium">{loves}</span>
    </button>
  </form>
  <span class="text-sm font-medium">people loved this</span>
</div>
